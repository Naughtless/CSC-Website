<!doctype html>
<html lang="en">
    <head>
        <title>Cyber Security Community</title>

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="shortcut icon" href="./../images/logo_csc.png" type="image/x-icon" />
        <!-- CSS Stylesheets -->
        <link rel="stylesheet" href="./../css/base.css" />
        <link rel="stylesheet" href="./../css/article.css" />
        <link rel="stylesheet" href="./../css/index.css" />
        <link rel="stylesheet" href="./../css/owlCarousel.css" />
        <link
            rel="stylesheet"
            href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
            integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
            integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css"
            integrity="sha512-tS3S5qG0BlhnQROyJXvNjeEM4UpMXHrQfTGmbQ1gKmelCxlSEBUaxhRBj/EFTzpbP4RVSrpEikbmdJobCvhE3g=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />
    </head>
    <body>
        <div id="content">
            <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top moved">
                <div class="container-fluid custom-mobile-margin-effect">
                    <a class="navbar" href="./../index.html">
                        <img src="./../images/logo_csc_50x50.png" class="img-fluid" alt="" />
                    </a>
                    <button
                        class="navbar-toggler justify-content-end"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#web-navigation"
                        aria-controls="navigation"
                        aria-expanded="false"
                        aria-label="Toggle navigation"
                    >
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse justify-content-end" id="web-navigation">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a
                                    class="nav-link ms-3 me-lg-3 custom-navbar-underline-effect"
                                    aria-current="page"
                                    href="./../index.html"
                                    >HOME</a
                                >
                            </li>
                            <li class="nav-item">
                                <a
                                    class="nav-link ms-3 me-lg-3 custom-navbar-underline-effect"
                                    aria-current="page"
                                    href="./../article.html"
                                    >ARTICLE</a
                                >
                            </li>
                            <li class="nav-item">
                                <a
                                    class="nav-link ms-3 me-lg-3 custom-navbar-underline-effect"
                                    aria-current="page"
                                    href="./../division.html"
                                    >DIVISION</a
                                >
                            </li>
                            <li class="nav-item">
                                <a
                                    class="nav-link ms-3 me-lg-3 custom-navbar-underline-effect"
                                    aria-current="page"
                                    href="./../ourpeople.html"
                                    >OUR PEOPLE</a
                                >
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <div class="content-bg">
                <div class="write">
                    <h2><div class="article-title">Hack The Box Web Challenge: Templated</div></h2>
                    <p class="writer">Jeffrey Jingga, Khumaira Malik Anabil & Paul Bright Yaftoran</p>
                    <br />
                    <img src="./../images/article/WU2/Grup1/templated/Picture1.jpg" alt="" class="img-fluid" />
                    <p class="penjelasan">
                        Pertama kita memasukan IP Address:Port yang diberikan yaitu 134.209.17.29:32276
                    </p>

                    <img src="./../images/article/WU2/Grup1/templated/Picture2.jpg" alt="" class="img-fluid" />
                    <p class="penjelasan">
                        Setelah melakukan inspect element terhadap komponen website, hanya ditemukan informasi bahwa
                        website dibuat dengan Flask/Jinja2
                    </p>

                    <img src="./../images/article/WU2/Grup1/templated/Picture3.png" alt="" class="img-fluid" />
                    <p class="penjelasan">
                        Setelah melihat request header, ditemukan bahwa website ini menggunakan Werkzeug
                    </p>
                    <p>
                        Setelah melakukan pencarian informasi, ditemukan informasi di bawah ini yang mengatakan terdapat
                        path console yang bisa diakses
                    </p>
                    <img src="./../images/article/WU2/Grup1/templated/Picture4.jpg" alt="" class="img-fluid" />
                    <p class="penjelasan">
                        Setelah mencoba mengakses website dengan path /console mengembalikan sebuah error 404 not found.
                        Tetapi, jika dilihat dengan baik website mengembalikan text yang sama dengan yang dimasukkan
                        sebagai path yang kita cari. Ini mempunyai kemungkinan vulnerable terhadap serangan SSTI (Server
                        Side Template Injection).
                    </p>

                    <img src="./../images/article/WU2/Grup1/templated/Picture5.jpg" alt="" class="img-fluid" />
                    <p class="penjelasan">
                        Kemudian kita langsung mencoba memasukkan payload matematika simple kedalam path website
                        tersebut seperti {{2+2-1}}
                    </p>
                    <img src="./../images/article/WU2/Grup1/templated/Picture6.jpg" alt="" class="img-fluid" />
                    <p class="penjelasan">
                        Website mengembalikan hasil perhitungan yang berarti website ini vulnerable terhadap serangan
                        SSTI. Kemudian setelah beberapa percobaan payload dan googling kita dapat melakukan ssti dengan
                        mengakses sebuah subprocess bernama popen
                    </p>

                    <img src="./../images/article/WU2/Grup1/templated/Picture7.png" alt="" class="img-fluid" />
                    <p class="penjelasan">
                        Dari sini bisa dilihat kalau mro mengembalikan list dari hierarchy class.kita bisa mengakses
                        subclass dari class object dengan menambahkan [1] didepan __mro__
                    </p>
                    <br />
                    <img src="./../images/article/WU2/Grup1/templated/Picture8.jpg" alt="" class="img-fluid" />
                    <p class="penjelasan">Dari sini kita dapat mencari indexnya dengan memodifikasi payload.</p>

                    <img src="./../images/article/WU2/Grup1/templated/Picture9.jpg" alt="" class="img-fluid" />
                    <p class="penjelasan">
                        414 merupakan index untuk subprocess.Popen. Disini kita dapat memakainya sesuai dengan blog ini.
                    </p>
                    <p class="flag">
                        Payload =
                        {{''.__class__.__mro__[1].__subclasses__()[414]('ls',shell=True,stdout=-1).communicate()}}
                    </p>
                    <img src="./../images/article/WU2/Grup1/templated/Picture10.jpg" alt="" class="img-fluid" />
                    <p class="penjelasan">
                        Payload tersebut mengembalikan isi list folder. Disana juga terdapat sebuah file yang kita
                        inginkan yaitu flag.txt. Setelah mengganti command menjadi 'cat flag.txt' kita mendapatkan flag
                        dari challenge ini.
                    </p>
                    <br />
                    <img src="./../images/article/WU2/Grup1/templated/Picture11.jpg" alt="" class="img-fluid" />
                    <br />
                    <p class="flag">Flag:{t3mpl4t3s_4r3_m0r3_p0w3rful_th4n_u_th1nk!}</p>
                    <br />
                    <h3>Thank you for reading!</h3>
                </div>
            </div>
            <footer class="website-footer bg-dark">
                <div class="footer d-flex justify-content-center">
                    <ul class="list-unstyled flex-row">
                        <li class="list-inline-item h4 mt-3 ps-3 pe-3 m-0">
                            <a
                                class="btn-floating btn-tw text-light"
                                href="https://twitter.com/cscbinus"
                                target="_blank"
                            >
                                <i class="fab fa-twitter"> </i>
                            </a>
                        </li>
                        <li class="list-inline-item h4 mt-3 ps-3 pe-3 m-0">
                            <a
                                class="btn-floating btn-gplus text-light"
                                href="mailto:cscbinanusantara@gmail.com"
                                target="_blank"
                            >
                                <i class="fab fa-google-plus-g"> </i>
                            </a>
                        </li>
                        <li class="list-inline-item h4 mt-3 ps-3 pe-3 m-0">
                            <a
                                class="btn-floating btn-li text-light"
                                href="https://www.linkedin.com/company/cyber-security-community"
                                target="_blank"
                            >
                                <i class="fab fa-linkedin-in"> </i>
                            </a>
                        </li>
                        <li class="list-inline-item h4 mt-3 ps-3 pe-3 m-0">
                            <a
                                class="btn-floating btn-li text-light"
                                href="https://timeline.line.me/user/_dcmePWpWazdrgV3mGzrSArsteB0AheHBdXnJD5o?utm_medium=windows&utm_source=desktop&utm_campaign=OA_Profile"
                                target="_blank"
                            >
                                <i class="fab fa-line"> </i>
                            </a>
                        </li>
                        <li class="list-inline-item h4 mt-3 ps-3 pe-3 m-0">
                            <a
                                class="btn-floating btn-li text-light"
                                href="https://www.instagram.com/cscbinus/"
                                target="_blank"
                            >
                                <i class="fab fa-instagram"> </i>
                            </a>
                        </li>
                        <li class="list-inline-item h4 mt-3 ps-3 pe-3 m-0">
                            <a
                                class="btn-floating btn-li text-light"
                                href="https://www.facebook.com/cscbinus/"
                                target="_blank"
                            >
                                <i class="fab fa-facebook-f"> </i>
                            </a>
                        </li>
                    </ul>
                </div>
            </footer>
        </div>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://code.jquery.com/jquery-3.6.0.js"
            integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"
            integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
    </body>
</html>
